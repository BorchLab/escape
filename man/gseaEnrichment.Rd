% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gseaEnrichment.R
\name{gseaEnrichment}
\alias{gseaEnrichment}
\title{Classical GSEA-style Running-Enrichment Plot}
\usage{
gseaEnrichment(
  input.data,
  gene.set.use,
  gene.sets,
  group.by = NULL,
  summary.fun = "mean",
  p = 1,
  rug.height = 0.02,
  digits = 2,
  palette = "inferno"
)
}
\arguments{
\item{input.data}{A \link[SeuratObject]{Seurat} object or a
\link[SingleCellExperiment]{SingleCellExperiment}.}

\item{gene.set.use}{Character(1).  Name of the gene set to display.}

\item{gene.sets}{A named list of character vectors, the result of
[getGeneSets()], or the built-in data object [escape.gene.sets].}

\item{group.by}{Metadata column. Defaults to the Seurat/SCE `ident` 
slot when `NULL`.}

\item{summary.fun}{Method used to collapse expression within each}

\item{rug.height}{Vertical spacing of the hit rug as a fraction of the
y-axis (default `0.02`).}

\item{digits}{Number of decimal places displayed for ES in the
legend (default `2`).}

\item{palette}{Character. Any palette from \code{\link[grDevices]{hcl.pals}}.}
}
\value{
A single `patchwork`/`ggplot2` object
}
\description{
Produces the familiar two-panel GSEA graphic—running enrichment score
(RES) plus a “hit” rug—for a **single gene-set** evaluated across
multiple biological groups (clusters, conditions, samples, …).  
The maximal signed deviation of each running-score curve is taken as
the enrichment score (**ES**) and printed directly inside the legend
label, e.g. `Cluster-A (ES = 1.42)`.
}
\details{
**Algorithm (Subramanian _et al._, PNAS 2005)**  
1. Within every group, library-size-normalise counts to CPM.  
2. Collapse gene expression with `summary.fun` (mean/median/…).  
3. Rank genes (descending) to obtain one ordered list per group.  
4. Compute the weighted Kolmogorov–Smirnov running score  
   (weight = \|stat\|^*p*).  
5. ES = maximum signed deviation of the curve.
}
\examples{
data(pbmc_small)

GS <- list(Immune = c("CD3D","CD3E","CD3G","MS4A1","CD79A","CD79B"))
gseaEnrichment(pbmc_small,
               gene.set.use = "Immune",
               gene.sets    = GS,
               group.by     = "groups",
               summary.fun  = "median",
               digits       = 3)

}
\seealso{
\code{\link{escape.matrix}}, \code{\link{densityEnrichment}}
}
