% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/heatmapEnrichment.R
\name{heatmapEnrichment}
\alias{heatmapEnrichment}
\title{Generate a heatmap to visualize enrichment values}
\usage{
heatmapEnrichment(
  input.data,
  assay = NULL,
  group.by = NULL,
  gene.set.use = "all",
  cluster.rows = FALSE,
  cluster.columns = FALSE,
  facet.by = NULL,
  scale = FALSE,
  summary.stat = "mean",
  palette = "inferno"
)
}
\arguments{
\item{input.data}{Output of \code{\link{escape.matrix}} or a single‑cell
object previously processed by \code{\link{runEscape}}.}

\item{assay}{Name of the assay containing enrichment data when
`input.data` is a single‑cell object.}

\item{group.by}{Metadata column used to define columns in the heatmap.
Defaults to the Seurat/SCE `ident` slot.}

\item{gene.set.use}{Vector of gene‑set names to plot, or \code{"all"}
(default) to show every available gene set.}

\item{cluster.rows, cluster.columns}{Logical; if \code{TRUE}, rows/columns
are ordered by Ward‑linkage hierarchical clustering (Euclidean distance).}

\item{facet.by}{Optional metadata column to facet the heatmap.}

\item{scale}{If \code{TRUE}, Z‑transforms each gene‑set column _after_
summarisation.}

\item{summary.stat}{Character keyword (\code{"mean"}, \code{"median"},
\code{"sum"}, \code{"sd"}, \code{"max"}, \code{"min"},
\code{"geometric"}) **or** a custom function to collapse scores within
each group.  Defaults to \code{"mean"}.}

\item{palette}{Any palette from \link[grDevices]{hcl.pals}; default
\code{"inferno"}.}
}
\value{
A \code{ggplot2} object.
}
\description{
This function allows to the user to examine the heatmap with the mean
enrichment values by group. The heatmap will have the gene sets as rows
and columns will be the grouping variable.
}
\examples{
gs <- list(B  = c("MS4A1","CD79B","CD79A"),
           T  = c("CD3D","CD3E","CD3G"))
pbmc <- SeuratObject::pbmc_small |>
  runEscape(gene.sets = gs, min.size = NULL)
heatmapEnrichment(pbmc, assay = "escape", palette = "viridis")
}
